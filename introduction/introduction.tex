\section{Project description}
The project description, written by A. Malthe-s{\o}renssen summarizes very well the project, in addition to how this work is highly relevant for the shale industry.\\
Most of the worlds currently accessible hydrocarbon resources are found in tight rocks - rocks with permeabilities in the millidarcy range and with pore sizes in the nanometer range. The development of technologies for production from tight rocks have changed the energy landscape, making countries such as US self-sufficient with gas and possibly also with oil, and the estimates from the producable reserves of hydrocarbons in tight rocks are continuously increased as new methods are developed and new plays are discovered. However, we are now at a stage where technological and engineering methods have surpassed our basic scientific understanding of production from tight rock systems.\\
Tight rocks pose new scientific problems because of the small length-scales involved. Traditional oil plays are found in for example sand stone reservoirs with millimeter to micrometer sized pores. For such systems, standard hydrodynamics is a sufficient tool to understand, describe and predict fluid transport, even for multiphase systems. However, in tight rocks, typical pore sizes are in the range of tens to hundres of nanometers. For such systems, the finite size of the atoms and molecules that make out fluids and surfaces become important: The dielectric properties of water and surface charge distributions, the binding energies of the fluids to the surfaces, and the effects of surface shapes and irregularities on effective surface interactions become important. For example, the usual assumption in fluid mechanics of no-slip boundary conditions may no longer hold, the fluids may behave differently close to surfaces than in bulk, and for smaller pores the surface to volume ratio is larger than for larger systems, and for gases the mean free path may become comparable to the characteristic sizes of the porous medium. These effects introduce challenges in how to describe and model fluid flow and surface reactions in tight rocks.\\
We have initiated an activity in tight rocks to address tight-rocks-specific effects for enhanced hydrocarbon production and CO2 storage. A part of that initiative requires the development of better models to address fluid flow, both liquids and gases, in tight rocks geometries with a particular focus on shale systems. In this project, we will address fluid flow in tight rocks systems by developing models to address atomistic effects for dilute gases and water in hydrophilic systems. To do this we need different models spanning various length scales. To address the flow of dilute gases in complex geometries on nanometers to micrometer length scales we will develop a method called Direct Simulation Monte Carlo (DSMC), that models a gas through effective particles that collide with other gas particles with stochastic collision rules that conserves momentum and that interacts with surfaces through special reflection rules that can be tuned using for example theoretical, experimental or atomic scale modeling results. Such models have proven useful to address dilute gas flows in regular geometries, such as for tube and channel flows, but we need very general tools to address the complex geometries of tight rocks system as found in experimental, tomographical studies. To supplement the modeling of dilute gases, we will also need methods to address the dynamics and flow of water in small pores using atomic scale models. In that case we need to model specific materials, and we have access to a very good molecular dynamics (MD) model for the interaction between water and silicates that we plan to develop and use to address fluid flow in nanoscale geometries.
In this project we will develop both a DSMC and a MD model to address gas and liquid flow in tight rocks system.
\section{Shale gas extraction}


\section{Goals}
\renewcommand{\thesubsection}{\thesection.\alph{subsection}}
In order to be able to study flow in systems with channels and pore sizes on the nanometer scale, we have chosen a set of goals to be achieved during the work in this thesis. Achieving these goals combined will lead to a solid base understanding of how the physics of fluids works at this scale, as well as having developed great tools for further study. The goals are twofold, software development and application of the software. 
\subsection{Develop a three-dimensional parallel DSMC model}
The DSMC model has been used for the past 50 years to study flow of dilute gases in systems where the mean free path is of the same order as a characteristic size of the geometry. Having an implementation of this model will allow us to simulate flow in systems with channels so small that continuum mechanics do not longer produce correct physics. The implementation needs to be parallelized for large-scale parallel machines so that large systems are possible to simulate.
\subsection{Develop methods to model arbitrary 3d geometries}
Important systems for theoretical purposes are for example cylinders or simple, mathematically well-described geometries. They can in many cases have analytical solutions and be excellent test cases for a more general numerical model. Real fracture networks are usually defined by a complicated geometry, so we need to find a way to represent arbitrary geometries.
\subsection{Develop a three-dimensional parallel MD model}
Different surface materials may interact very differently with a given fluid. Take for example water. Some surfaces are hydrophilic, which means that they attract water, whereas hydrophobic materials tends to repell water. This will of course affect how the fluid flows through a system. The DSMC model is a particle model that performs stochastic collisions between particles and the surface. The collision rules have parameters that depends on the combination of the specific surface material and fluid substance. With a good MD model, we can both study flow in small systems and compute the gas-surface parameters we need in DSMC. 
\subsection{Develop custom 3d visualization tools for large particle data sets}
Already existing free visualization software have drawbacks that we will address later. 

\subsection{Study flow and dynamics of water in simple nanoscale silicates}

\subsection{Gain insight with correction factors for permeabilities in nanoporous media}
It is well-known from experiments that the measured permeabilities in nanoporous media can be two orders of magnitues higher than the theoretical predicted values. Klinkenberg explained this effect by the fact that the fluid can have a non-zero velocity near the boundaries\cite{klinkenberg1941permeability}. Slip velocity leads to a correction to the theoretically predicted permeability. We will study flow in different nanoporous media to see how well these corrections predicts the permeability in the stochastic DSMC model as well as the MD model for systems with different pore sizes covering two orders of magnitudes.
\renewcommand{\thesubsection}{\thesection.\arabic{subsection}}
\section{The structure of this thesis}
This document is arranged in five parts. Chapter \ref{chap:theory_of_fluids} opens with a brief discussion about the theory of fluid mechanics. We discuss how the continuum approach in standard hydrodynamics breaks down for dilute gases in nanoporous media, and what the current theory has to offer in predictions of the permeability. 

\section{My contribution}
In every thesis, as in any scientific work, the foundation of the content is results from previous work. It should be clear what the author has contributed with that is unique and maybe not easily obtainable for everyone without this work. This could for example be new theoretical calculations, models, algorithms or tools that has been developed. Since a master thesis is a larger document containing more information than just the new contributions, it might be less obvious which parts that are the work of the author. A thesis like this deserves its own section highlighting these parts.\\
We have studied two different models in this thesis; Molecular Dynamics (MD) and Direct Simulation Monte Carlo (DSMC). Both of these models have been written from scratch. Doing this has given me a great insight in both models, especially from a numerical perspective since every detail of the implementation had to be understood. In this section we briefly discuss the contributions by \todo{check of/by} the author. This section is not meant to be an introduction to any of the concepts, so it is assumed that the reader is familiar with the models at the time of reading. If this is not the case, everything in this section should be clear after reading about both models in chapters \ref{chap:dsmc}, \ref{chap:dsmc_implementation}, \ref{chap:md}, \ref{chap:md_implementation} and \ref{chap:opengl}.
\subsection{Direct Simulation Monte Carlo}
In the DSMC model, we needed to represent the geometry of the system (of which the fluid is confined in). This method had to be fast, scalable (for parallelizing) and general so that we can represent an arbitrary geometry. To be able to perform collisions between the surface and particles, the surface needed to have well defined normal and tangent vectors in every available collision point. The author has developed a voxelation model of the geometry with a new method to calculate the normal and tangent vectors using the neighboring voxels to have a smoother effective surface than just voxels. This method is discussed in detail in section \ref{sec:dsmc_complex_geometries}.
\subsection{Molecular Dynamics}
The MD code is a standard, but remarkably efficient code using the Lennard-Jones potential. The code structure and parallelization technique is based on what is teached at the University of Southern California \footnote{See \url{http://cacs.usc.edu/education/cs596/ParallelMD-VG.pdf} for details.}. In section \ref{sec:md_complex_geometries} we describe that we want to simulate a fluid in an arbitrary geometry with the MD code. The author has developed a simple, but very useful model of a solid that allows some of the atoms in the system to behave as a solid, vibrating about their equilibrium point. In addition, with an applied thermostat on these atoms, we are able to drain the system for energy which is a necessity when we induce flow in the system by adding a constant force as described in section \ref{md:pressure_driven_flows}. The details of this model is discussed in section \ref{sec:md_complex_geometries}.
\subsection{Visualization}
The free visualization software available (such as VMD, Ovito, ParaView) are great tools for studying datasets from numerical atomic or molecular models. There are two significant drawbacks the author has noticed; the camera control and performance while visualizing large data sets. In all of these programs, the camera is pointing (read looking) towards a point (which can be moved) whereas the mouse controls the rotation around this point. To be able to study different parts of the system in detail, one could want to control the camera as in a first person shooter game. The author has, together with Svenn-Arne Dragly, developed visualization tools allowing us to visualize up to 100 million atoms simultaneously with decent frame rate with a camera control as described above. In chapter \ref{chap:opengl} we discuss how to make full use of what's called \textit{geometry shaders} which allows us to create the geometry used to render the spheres representing the atoms on the Graphical Processing Unit (GPU).