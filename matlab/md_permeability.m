B = [0.100117358589 3.62117504672e-13 4.27657975355e-13 0.846745590026
0.199925812299 5.14137102086e-13 5.7472541462e-13 0.894578678804
0.300100912961 6.76249762031e-13 7.26436346637e-13 0.930913995647
0.400443654169 8.44329612954e-13 8.81827434467e-13 0.957477143432
0.500522346626 9.97000338308e-13 1.03972216553e-12 0.958910342939
0.598815144769 1.13463362819e-12 1.19724042918e-12 0.947707411585
0.700190423668 1.32560870175e-12 1.36189929096e-12 0.973352956821
0.800784207501 1.48261338538e-12 1.52722024969e-12 0.97079212097
0.902305152867 1.66137170285e-12 1.69577937805e-12 0.979709816239
0.989263950996 1.80574912837e-12 1.84137828697e-12 0.980650820719
1.99887266191 3.61898507475e-12 3.58740147132e-12 1.0088040337
2.99927276946 5.22630331931e-12 5.3748799212e-12 0.972357223961
4.0028904272 7.18657856809e-12 7.1974933519e-12 0.998483529853
5.00039527642 8.04805243778e-12 9.02689732477e-12 0.89156352933
5.98124204218 1.09777639409e-11 1.08376411565e-11 1.01292926961
7.0050582476 1.24728081183e-11 1.27369172152e-11 0.979264284088
7.77561465483 1.50425035623e-11 1.41712238908e-11 1.06148231643
9.0152053969 1.48104918785e-11 1.64855416636e-11 0.898392796593
9.96873673696 1.93788138718e-11 1.82705853313e-11 1.0606564333];

knudsen_numbers = B(:,1);
permeabilities = B(:,2);

radius_si = 15.1488000213e-9;

absolute_permeability = radius_si^2/8;
analytical_permeabilities = knudsen_correction_factor(knudsen_numbers)*absolute_permeability;
analytical_permeabilities = analytical_permeabilities*1e4;

subplot(1,2,1);
h = semilogx(knudsen_numbers, permeabilities,...
    'LineWidth',1.5,...
    'LineStyle','o',...
    'color','r'...
    );
permeabilities
analytical_permeabilities

hold on;
semilogx(knudsen_numbers, analytical_permeabilities,...
    'LineWidth',1.5...
    );
fontsize = 20;
hax = gca;
set(hax, 'fontsize',fontsize ...
    );
xlabel('Knudsen number',...
    'fontsize',fontsize...
    );
ylabel('Permeability [cm^2]',...
    'fontsize',fontsize ...
    );
title('Cylinder permeability',...
    'fontsize',fontsize ...
    );
legend({'MD','Knudsen corrected analytical'},...
    'fontsize',fontsize,...
    'location', 'northwest'...
    );
set(hax,'xlim',[.1 10])
set(hax, 'xminortick', 'on')

subplot(1,2,2);
h = plot(knudsen_numbers, permeabilities,...
    'LineWidth',1.5,...
    'LineStyle','o',...
    'color','r'...
    );
permeabilities
analytical_permeabilities

hold on;
plot(knudsen_numbers, analytical_permeabilities,...
    'LineWidth',1.5...
    );
fontsize = 20;
hax = gca;
set(hax, 'fontsize',fontsize ...
    );
xlabel('Knudsen number',...
    'fontsize',fontsize...
    );
title('Cylinder permeability',...
    'fontsize',fontsize ...
    );
legend({'MD','Knudsen corrected analytical'},...
    'fontsize',fontsize,...
    'location', 'northwest'...
    );
set(hax,'xlim',[.1 10])
set(hax, 'xminortick', 'on')
set(hax, 'yminortick', 'on')